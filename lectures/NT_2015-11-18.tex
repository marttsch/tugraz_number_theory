\documentclass[NumTh.tex]{subfiles}
\begin{document}

\begin{cor}[2.1.3 \label{cor_2_1_3}]
  Let $n \in \N$, $m_1,\dots,m_n \in \N$ and $a_{ij} \in \Z$ $(1\leq i,j \leq n)$.
  Then 
  \[ \Lambda = \{ x \in \Z^n : \sum_{j=1}^n a_{ij} x_j \equiv 0 \bmod m_i (1 \leq i \leq n) \} \]
  is a lattice in $\R^n$.
\end{cor}

\begin{proof}
  As $\Lambda \subset \Z^n$, it is discrete. Clearly $0 \in \Lambda$, and if $x_1,x_2 \in \Lambda$ then $x_1 + x_2 \in \Lambda$.
  So $\Lambda$ is a discrete additive subgroup of $\Z^n$.
  Moreover, the $n$ linearly independent vectors ($m,0,\dots,0),\dots,(0,\dots,0,m)$ where $m = m_1 \cdot \dots \cdot m_n$
  are all in $\Lambda$.
  Hence, by Theorem \ref{th_2_1_2} we conclude that $\Lambda$ is a lattice in $\R^n$.
\end{proof}


\subsection{The Theorems of Blichfeldt and Minkowski}

Minkowski's First and Second Theorem are possibly some of the most useful theorems in number theory.
We will deduce Minkowski's First Theorem via Blichfeldt's Theorem which is of interest for its own sake.

\begin{theorem}[Blichfeldt \label{th_2_2_1_blichfeldt}]
  Let $\Lambda$ be a lattice in $\R^n$, and let $S \subset \R^n$ be measurable such that $\vol S > \det \Lambda$ ($\vol S = \infty$ is allowed).
  Then 
  \[ \exists x_1,x_2 \in S, x_1 \neq x_2 \text{ and } x_1 - x_2 \in \Lambda \text{.}\]
\end{theorem}

\begin{proof}
  Let $b_1,\dots,b_n$ be a basis of $\Lambda$ and let $F = [0,1) b_1 + \dots + [0,1) b_n$ be a fundamental cell.
  Thus $\vol F = \det \Lambda$, and if $x \in \R^n$ then $\exists$ \underline{unique} $v \in \Lambda$ and $\theta \in F$ such that
  \[ x = V + \theta \text{.}\]
  Now for each $v \in \Lambda$ consider
  \[ \mathcal{R}(v) = \{ \theta \in F : v + \theta \in S \} \]
  %TODO add picture
  Hence, 
  \[ \sum_{v \in \Lambda} \vol(\mathcal{R}(v)) = \vol S \]
  Now if $\vol S > \det \Lambda$ then (2.1) implies $\sum_{v \in \Lambda} \vol (\mathcal{R}(v)) > \det \Lambda = \vol F  $.
  But $\cup_{v \in \Lambda} \mathcal{R}(v) \subset F$; so the union \underline{cannot} be disjoint.
  Thus $\exists v_1,v_2 \in \Lambda, v_1 \neq v_2$ such that $\theta_0 \in \mathcal{R}(v_1) \cap \mathcal{R}(v_2)$.
  Hence, the points $x_1 = v_1 + \theta_0, x_2 = v_2 + \theta_0$ are both in $S$ and $x_1 - x_2 = v_1 - v_2 \in \Lambda \setminus 0$.
\end{proof}

\begin{theorem}[Mnkowski's First Theorem \label{th_2_2_2_minkowski1}]
  Let $\Lambda$ be a lattice in $\R^n$, and let $S \subset \R^n$ be convex and symmetric.
  Suppose that either
  \begin{itemize}
    \item $\vol S > 2^n \det \Lambda$ ($\vol S = \infty$ allowed) \\
    or
    \item $\vol S \geq 2^n \det \Lambda$ and $S$ is compact
  \end{itemize}
  Then $S$ contains a \underline{non-zero} lattice point.
\end{theorem}

\begin{rem}
  $2^n$ is sharp, take $\Lambda = \Z^n$ and $S = (-1,1)^n$,
  then $\vol S = 2^n$, $\det \Lambda = 1$, $S$ is symmetric and convex, but $S \cap \Lambda = \{ 0\}$.
\end{rem}

\begin{proof}
  First suppose $\vol S > 2^n \cdot \det \Lambda$.
  Now $\vol \left( \frac{1}{2}S \right) = 2^{-n} \vol S > \det \Lambda$.
  By Theorem \ref{th_2_2_1_blichfeldt} (with the set $\frac{1}{2} S$) we see that $\exists x_1,x_2 \in S$,
  $x_1 \neq x_2$ such that $\frac{1}{2} x_1 - \frac{1}{2} x_2 \in \Lambda \setminus 0$.
  But $S$ is symmetric, thus $-x_2 \in S$.
  As $S$ is convex we conclude that $\frac{1}{2} x_1 + \frac{1}{2} (-x_2) \in S$.
  This proves the first part.\\
  Now suppose $S$ is compact and $\vol S = 2^n \det \Lambda$.
  If $v \in \Lambda \setminus S$ then $\exists \varepsilon_v > 0$ such that $B_{\varepsilon_v}(v) \cap S = \emptyset$ ($S^c$ is open!)
  where $B_r(y) = \{ x \in \R^n : \abs{x - y} < r \}$.
  As $S$ is compact $\exists R > 0$ such that $\lambda S \subset B_R (0)$ for all $\lambda$ with $0 < \lambda <2$.
  So $(\Lambda \setminus S) \cap B_R(0)$ is finite by Theorem \ref{th_2_1_2} and hence $\exists \varepsilon > 0$
  such that 
  \[ B_\varepsilon(v) \cap S = \emptyset  \; \forall v \in (\Lambda \setminus S) \cap B_R(0) \text{.} \]
  %TODO add picture
  Hence, $\exists \lambda > 1$ such that
  \[ \lambda S \cap \Lambda = S \cap \Lambda \text{.} \]
  By the first part we know that $\lambda S$ contains a non-zero lattice point, and this completes the proof.
\end{proof}

\begin{cor}\label{cor_2_2_3}
  Let $\Lambda$ be a lattice in $\R^n$ and let $a_{ij} \in \R \; (1 \leq i,j \leq n)$.
  Suppose $c_1,\dots, c_n > 0$ and $c_1 \dots c_n \geq \abs{\det A} \det \Lambda$.
  Then $\exists u \in \Lambda \setminus 0$ such that 
  (2.2) $\begin{cases}  
    \abs{ \sum_{j=1}^n a_{ij} u_j} \leq c_1\\
    \abs{ \sum_{j=1}^n a_{ij} u_j} < c_i \: (2 \leq i \leq n) \text{.}
  \end{cases}$
\end{cor}

\begin{proof}
  First suppose $\det A \neq 0$.
  Then $\mathcal{L} = A - \Lambda$ is  a lattice in $\R^n$ with $\det \mathcal{L} = \abs{\det A} \det \Lambda$.
  Then (2.2) means we are looking for a non-zero lattice point $x \in \mathcal{L}$ such that
  \[ \abs{x_1} \leq c_1 \]
  \[ \abs{x_i} < c_i \: (2 \leq i \leq n) \]
  These inequalities define a symmetric, convex set of points $x \in \R^n$
  with volume $= 2^n c_1 \dots c_n$. So if $c_1\dots c_n > \abs{\det A} \det \Lambda$ then we can apply Theorem \ref{th_2_2_2_minkowski1} and the claim follows at once.
  Next let $0 < \varepsilon < 1$.
  Then the set
  \begin{align*}
  S_\varepsilon: & \abs{x_1} &\leq c_1 + \varepsilon < c_1 + 1 \\
  & \abs{x_i} &< c_i \: (2 \leq i \leq n)
  \end{align*}
  still has a non-zero lattice point in $\mathcal{L}$.
  But these sets $S_\varepsilon$ all lie in $S_1$ which lies in compact set and hence has only finitely many lattice points.
  Hence, there must be a non-zero lattice point o $\mathcal{L}$ in $S_0$. 
  This proves the Corollary if $\det A \neq 0$.
  Now if $\det A = 0$ then (2.2) defines a set of points $u \in \R^n$ of infinite volume and so Theorem \ref{th_2_2_2_minkowski1} applies again and yields the claim.
\end{proof}

\begin{cor}[Lagrange\label{cor_2_2_4_lagrange}]
  Every positive integer is the sum of four squares.
\end{cor}

\begin{proof}
  First we observe that 
  \[ (x_1^2 + x_2^2 + x_3^2 + x_4^2) \cdot (y_1^2 + y_2^2 + y_3^2 + y_4^2) = (x_1 y_1 + x_2 y_2 x + x_3 y_3 + x_4 y_4)^2
  + (-x_1 y_2 + x_2 y_1 -x_3 y_4 + x_4y_3)^2 + (-x_1 y_3 + x_2 y_4 + x_3 y_1 - x_-2 y_2)^2 + (-x_1 y_4 - x_2 y_3 + x_3y_2 + x_4 y_1)^2 \text{.} \]
  Now $1 = 1^2 + 0^2 + 0^2 + 0^2$. So it suffices to prove the claim for primes $p$.
  Now $2 = 1^2 + 1^2 + 0^2 + 0^2$; so we can assume $p \neq 2$.
  Now $a^2$ and $-(b^2 + 1)$ run through exacty $\frac{p+1}{2}$ distinct residue classes modulo $p$ as $a \bmod b$ run through an entire system of residue classes. ($0^2, 1^2, \dots, \left( \frac{p-1}{2} \right)^2$ are all distinct in $\mathcal{F}_p$)\\
  Hence, they have a common residue class; thus 
  \[ \exists a,b \in \Z \text{ such that } a^2 + b^2 +1 \equiv 0 \bmod p \text{.} \]
  With this choice of $a \bmod b$ consider
  \[ \Lambda = A \cdot \Z^4 \text{ where } A= \left( 
  \begin{matrix}
    1 & 0 & 0 & 0\\
    0 & 1 & 0 & 0\\
    a & b & p &  0\\
    b & -a & 0 & p
  \end{matrix} \right) \text{.}\]
  So $\Lambda$ is a lattice in $\R^4$ with $\det \Lambda = p^2$.
  Next consider the convex, symmetric set 
  \[ S = \{ (x_1,\dots,x_4) \in \R4 : x_1^2 + \dots + x_4^2 < 2p \} \]
  Then $\vol S = \frac{\pi^2}{2} (2p)^4 = (2 \pi)^2 p^4 > 16 \cdot p^2 = 2^4 \det \Lambda$.
  By Theorem \ref{th_2_2_2_minkowski1} $\exists x \in \Lambda \cap S$, $x \neq 0$.
  Now 
  \[ x = \left(
  \begin{matrix}
    x_1 \\
    x_2 \\
    x_3
  \end{matrix} \right)
  = A \cdot z = \left(
  \begin{matrix}
    z_1 \\
    z_2 \\
    a z_1 + b z_2 + p z_3 \\
    b z_1 - a z_2 + p z_4
  \end{matrix} \right) \; (z \in \Z^4 \setminus 0) \]
  Hence,
  \[ x_1^2 + x_2^2 + x_3^2 + x_4^2 \equiv z_1^2 + z_2^2 + (a z_1 + b z_2)^2 + (b z_1 - a z_2)^2
  = \underbrace{(1 + a^2 + b^2)}_{\equiv 0 \bmod p} (z_1^2 + z_2^2) \equiv 0 \bmod p\]
  Since $x \in S$, and $x \neq 0$ we conclude that $x_1^2 + \dots + x_4^2 = p$.
  This proves the corollary.
\end{proof}

\end{document}
