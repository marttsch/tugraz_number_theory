\documentclass[NumTh.tex]{subfiles}
\begin{document}

\begin{lemma}
  Let $a_0,a_1,a_2,\dots$ be a sequence of integers with $a_i > 0$ ($i>0$).\\
  Define $p_n,q_n$:
  \begin{align}
    p_0 &= a_0\\
    q_0 &= 1\\
    p_1 &= a_0 a_1 + 1\\
    q_1 &= a_1\\
    p_n &= a_n p_{n-1} + p_{n - 2} \text{ for } n \geq 2\\
    q_n &= a_n q_{n-1} + q_{n-2} \text{ for } n \geq 2.
  \end{align}
  Then:
  \begin{enumerate} %a,b
    \item $p_n q_{n+1} - p_{n+1} q_n = (-1)^{n+1}$
    \item $\gcd(p_n,q_n) = 1$
    \item $p_n/q_n = [a_0,\dots,a_n]$
    \item If the $a_i$ are produced by the continued fraction process for $\theta$, then, for every $n \geq 1$, $\frac{p_n}{q_n}$ is the $n$-th convergent of $\theta$ and
    \[ \theta = \frac{p_n \theta_{n+1} + p_{n-1}}{q_n \theta_{n+1} + q_{n-1}} \]
  \end{enumerate}
\end{lemma}

\begin{proof}
  \begin{enumerate} %a,b
    \item We use induction on $n$. For $n = 0$ we note that 
    \[ p_0 q_1 - p_1 q_0 = a_0 a_1 - a_0 a_1 - 1 = -1.\]
    So the result holds for $n = 0$.\\
    Now suppose result holds for $n = m - 1$.\\
    consider case $n = m$. Using the recurrence relation, we set
    \begin{align}
      p_m q_{m+1} - p_{m+1} q_m &= p_m (a_m q_m + q_{m-1}) - q_m ( a_m p_m + p_{m-1})\\
      &= p_m q_{m-1} - p_{m-1}q_m = - (-1)^m = (-1)^{m+1}.
    \end{align}
    This proves claim for $n = m$.
    \item Immediate from (a)
    \item (c) + (d):\\
    Remark about $\frac{p_n}{q_n}$ in (d) follows directly from (c).
    We prove the rest of (d), along with (c), using induction on $n$. Remember that (c) a priori does not require that the $a_i$ are produced by the continued fraction process.\\
    Consider base case $n = 1$. For (c) note that $\frac{p_1}{q_1} = a_0 + \frac{1}{a_1} = [a_0,a_1]$.
    For (d) we note that
    \[ \frac{p_1 \theta_2 + p_0}{q_1 \theta_2 + q_0} = \frac{(a_0 a_1 +1) \theta_2 + a_0}{a_1 \theta_2 + 1} = a_0 + \frac{\theta_2}{a_1 \theta_2 +1} = a_0 + \frac{1}{a_1 + \frac{1}{\theta_2}} = \theta \]
    Next suppose (c) and (d) both hold for $n = m-1$, and consider $n = m$. Using (d)  with $n = m -1$ we get
    \[ [a_0, \dots, a_m ] = \frac{p_{m-1} a_m + p_{m-2}}{q_{m-1} a_m + q_{m-2}} = \frac{p_m}{q_m} \text{ by recurrence ralation.} \]
    This proves (c) for $n=m$.\\
    To prove (d) with $n=m$ we observe that
    \begin{align}
      \theta &= [a_0,\dots,a_m,\theta{m+1} ] \\
      &= [a_0,\dots,a_m + \frac{1}{\theta_{m+1}} ]\\
      &\overset{=}{(d) for n=m-1} \frac{p_{m-1} (a_m + \frac{1}{\theta_{m+1}} ) + p_{m-2}}{q_{m-1} (a_m \frac{1}{\theta_{m-1}} ) + q_{m-2}}\\
      &\overset{=}{rec. rel} \frac{p_m + p_{m-1} (\frac{1}{\theta_{m+1}})}{q_m + q_{m-1} ( \frac{1}{\theta_{m+1}})}\\
      &= \frac{p_m \theta_{m+1} + p_{m-1}}{q_m \theta_{m+1} + q_{m-1}}
    \end{align}
    which is (d) for $n=m$.
  \end{enumerate}
\end{proof}

Next we deduce some properties of continued fraction convergents.

\begin{theorem}
  Let $\theta = [a_0,a_1,a_2,\dots ]$ with convergents $\frac{p_n}{q_n}$.
  For (a) - (d) we assume that the continued fraction proves does not terminate
  \begin{enumerate} %a,b
    \item For all $n \in \N_0$, $\theta$ lies between $\frac{p_n}{q_n}$ and $\frac{p_{n+1}}{q_{n+1}}$.
    \item For all $n \in \N_0: \abs{\theta - \frac{p_n}{q_n}} \leq \frac{1}{q_n q_{n+1}}$
    \item For $n \geq 1$ we have $q_{n+2} \geq 2\cdot q_n$
    \item $\frac{p_n}{q_n} \to \theta$ as $n \to \infty$
    \item The continued fraction process terminates if and only if $\theta$ is rational.
  \end{enumerate}
\end{theorem}

\begin{proof}
  \begin{enumerate}
    \item Note $\theta = [a_0,\dots,a_n,\theta_{n+1} ] = [a_0,\dots,a_n+\frac{1}{\theta_{n+1}}$
    where $0 < \frac{1}{\theta_{n+1}} < \frac{1}{a_{n+1}}$. So that $\theta$ lies between $[a_0,\dots,a_n]$ and $[a_0,\dots,a_n + \frac{1}{a_{n+1}} ]$.
    But $[a_0,\dots,a_n + \frac{1}{a_{n+1}} = [a_0,\dots,a_{n+1}]$. This shows (a).
    \item By (a) we have $\abs{\theta - \frac{p_n}{q_n}} \leq \abs{\frac{p_n}{q_n} - \frac{p_{n+1}}{q_{n+1}}} = \abs{\frac{p_n q_{n+1} - p_{n+1} q_n}{q_n q_{n+1}}} \overset{\text{Lemma } 1.2.1(a)}{=} \frac{1}{q_n q_{n+1}}$
    \item Follows from the fact that $a_i >0 (i > 0 )$ using Lemma 1.2.1.
    \item Follows from (b) and (c)
    \item Only if part is obvious.\\
    Conversely suppose $\theta = \frac{a}{b} \in \Q$ but the process does \emph{not} terminate. Taking $n$ such that $q_n > b$ yields
    \[ | \theta - \frac{p_n}{q_n} | \overset{\frac{a}{b} \neq \frac{p_n}{q_n} \text{ as } q_n > b \text{ and } \gcd(p_n,q_n) = 1}{\geq} \frac{1}{b q_n} > \frac{1}{q_n q_{n+1}} \]
    contradicting (b).
  \end{enumerate}
\end{proof}

\begin{ex*}
  Take $\theta = \frac{16}{9}$. We have $a_0 = 1$. Then $\theta = 1 + \frac{7}{9}$ so $\theta_1 = \frac{9}{7}$ and $a_1 = 1$. 
  From $\theta_1 = \frac{9}{7} = 1 + \frac{2}{7}$ we get $\theta_2 = \frac{7}{2}$ and $a_2 = 3$.
  Form $\theta_2 = \frac{7}{2} = 3 + \frac{1}{2}$ we get $\theta_3 = 2$ and $a_3 = 2$.
  Thus $\theta = \frac{16}{9} = [1,1,3,2]$ and the convergents are $\frac{p_0}{q_0} = \frac{1}{1}, \frac{p_1}{q_1} = 1 + \frac{1}{1} = \frac{2}{1}, \frac{p_2}{q_2} = 1 + \frac{1}{1+\frac{1}{3}} = 1 + \frac{1}{\frac{4}{3}} = \frac{7}{4}$ 
  and $\frac{p_3}{q_3} = \frac{16}{9}$. \\
  Let's check some of the properties claimed.\\
  $p_1 q_2 + p_2 q_1 = 2\cdot 4 - 7 \cdot 1 = 1 \checkmark, p_2 q_3 - p_3 q_2 = 7\cdot 9 - 16 \cdot 4 = -1 \checkmark,
  \frac{p_2 \theta_3 + p_1}{q_2 \theta_3 +q_1} = \frac{ 7 \cdot 2 + 2}{4 \cdot 2 +1} = \frac{16}{9} = \theta \checkmark$
\end{ex*}

We now show that convergents give best-possible rational approximations.
\begin{theorem}
  Let $\theta$ be an irrational real number, and let $\frac{p_n}{q_n}$ be the convergents ($n \geq 0$) with partial quotients $a_n (n \geq 0)$.\\
  Then
  \begin{enumerate} %a,b
    \item $\abs{\theta - \frac{p_n}{q_n}}$ strictly decreases as $n$ increases.
    \item the convergents give successively closer approximations to $\theta$.
    \item $\frac{1}{(a_{n+1} + 2) q_n^2} < \abs{\theta - \frac{p_n}{q_n}} < \frac{1}{a_{n+1} q_n^2} \leq \frac{1}{q_n^2}$
    \item If $p,q \in \Z$ with $0 < q < q_{n+1}$ then
    \[ \abs{q \theta - p} \geq \abs{q_n \theta - p_n} \]
    Moreover, "$=$" only if $(p,q) = (p_n,q_n)$.\\
    (In this sense convergents are best-possible approximations.)
    \item If $(p,q) \in \Z \times \N$ and $\abs{\theta - \frac{p}{q}} < \frac{1}{2\cdot q^2}$ then $\frac{p}{q}$ is a convergent to $\theta$.
  \end{enumerate}
\end{theorem}

\begin{proof}
  \begin{enumerate}
    \item From Lemma 1.2.1(d) we have $\theta = \frac{p_n \theta_{n+1} + p_{n-1}}{q_n \theta_{n+1} + q_{n-1}}$.
    Using Lemma 1.2.1(a) we get
    \begin{align}
    \abs{q_n \theta - p_n} &= \abs{\frac{q_n p_n \theta_{n+1} + q_n p_{n-1} - p_n q_n \theta_{n+1} - p_n q_{n-1}}{q_n \theta_{n+1} + q_{n-1}}} \\
    &= \frac{1}{q_n \theta_{n+1} + q_{n-1}}\\
    &< \frac{1}{q_n + q_{n-1}}\\
    &= \frac{1}{(a_n +1) q_{n-1} + q_{n-2}}\\
    &< \frac{1}{\theta_n q_{n-1} + q_{n-2}}\\
    &= \abs{q_{n-1} \theta - p_{n-1}}
    \end{align}
    This shows (a) and (b) because the $q_n$ are increasing.
    \item[c] We use $a_{n+1} q_n^2 < \theta_{n+1} q_n^2 + q_n q_{n-1} < (a_{n+1} + 2) q_n^2$
    and combine it with the equation (proof part (a)),
    \[ \abs{\theta - \frac{p}{q}} = \frac{1}{q_n^2 \theta_{n+1} + q_n q_{n-1}} \]
    
    %---part from 27.10.2015
    
    \item[d)] By Lemma 1.2.1(a) we can find $\Vek{u}{v}{} \ in \Z^2$ such that
    \[ \left(\begin{matrix} p_n & p_{n+1}\\ q_n & q_{n+1} \end{matrix} \right) \Vek{u}{v}{} = \Vek{p}{q}{}. \]
    As $0 < q <q_{n+1}$ we have $u \neq 0$. If $v = 0$ then $(p,q) = u \cdot (p_n,q_n)$ and the claim is trivial. ($u = 1 \Rightarrow$ equality, $u > 1 \Rightarrow$ strictly >)\\
    So let's assume $v \neq 0$. Then $u$ and $v$ cannot both be negative (as $q > 0$) nor both be positive (as $q < q_{n+1}$).
    So they have opposite signs.\\
    By Theorem 1.2.2(a) also $q_n\theta - p_n$ and $q_{n+1} \theta p_{n+1}$ have opposite signs.
    Hence, $\abs{q \theta - p} = \abs{u (q_n \theta p_n) + v (q_{n+1} \theta - p_{n+1}} > \abs{q_n \theta - p_n}$.
    \item[e)] Take $n$ with $q_n \leq q < q_{n+1}$. Then 
    \begin{align*} 
    \abs{\frac{p}{q} - \frac{p_n}{q_n}} &\leq \abs{\theta - \frac{p}{q}} + \abs{\theta - \frac{p_n}{q_n}} \\
    &= \frac{\abs{q \theta - p}}{q} + \frac{\abs{q_n \theta - p_n}}{q_n}\\
    &\overset{\leq}{(d)} (\frac{1}{q} + \frac{1}{q_n}) \abs{q \theta - p } \\
    &\leq \frac{2}{q_n} \frac{1}{2q} \\
    &= \frac{1}{q q_n}
    \end{align*}
    Hence, $\frac{p}{q} = \frac{p_n}{q_n}$.
  \end{enumerate}
\end{proof}

\end{document}
